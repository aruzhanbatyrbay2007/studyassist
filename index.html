<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>StudyAssist â€” Meaning-Based Learning Assistant</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family: Arial, Helvetica, sans-serif;
  background:#0b1020;
  color:#eaf0ff;
}
header{
  padding:20px;
  background:#111836;
}
h1{margin:0;font-size:22px;}
.container{
  max-width:1100px;
  margin:auto;
  padding:20px;
}
.card{
  background:#151c3d;
  border-radius:12px;
  padding:20px;
  margin-bottom:20px;
}
button{
  padding:10px 14px;
  border-radius:10px;
  border:none;
  background:#5b7cff;
  color:white;
  cursor:pointer;
}
button.secondary{background:#444;}
textarea{
  width:100%;
  min-height:140px;
  background:#0f1430;
  color:white;
  border-radius:10px;
  padding:10px;
  border:none;
}
input[type=file]{margin:10px 0;}
label{font-size:14px;}
.task{
  background:#0f1430;
  border-radius:10px;
  padding:12px;
  margin:12px 0;
}
.ref{
  font-size:13px;
  color:#b9c3ff;
  margin-top:6px;
}
.ai{
  background:#1c255a;
  border-radius:12px;
  padding:15px;
  white-space:pre-wrap;
}
.badge{
  display:inline-block;
  background:#27307a;
  padding:5px 10px;
  border-radius:999px;
  font-size:12px;
  margin:4px;
}
.footer{
  text-align:center;
  font-size:12px;
  opacity:.6;
  padding:20px;
}
</style>
</head>

<body>
<header>
  <h1>StudyAssist â€” Meaning-Based Learning Assistant</h1>
</header>

<div class="container">

<!-- MODE -->
<div class="card">
  <label>
    <input type="checkbox" id="aiToggle">
    Use Real AI (GPT, optional)
  </label>
</div>

<!-- INPUT -->
<div class="card">
  <h3>Upload text or paste content</h3>
  <input type="file" id="fileInput" accept=".txt">
  <textarea id="textInput" placeholder="Or paste your study material here..."></textarea>
  <br><br>
  <button onclick="startAnalysis()">Analyze Material</button>
</div>

<!-- ANALYSIS -->
<div class="card">
  <h3>Meaning-Based Analysis</h3>
  <div class="ai" id="analysisBox">Waiting for input...</div>
</div>

<!-- TASKS -->
<div class="card">
  <h3>Study Tasks (Based on Meaning)</h3>
  <div id="tasksBox"></div>
</div>

</div>

<div class="footer">
StudyAssist â€” Hybrid Semantic + AI Project (HTML / CSS / JS)
</div>

<script>
const OPENAI_API_KEY = ""; // OPTIONAL

let fullText = "";

/* ---------- FILE / TEXT ---------- */
document.getElementById("fileInput").addEventListener("change", e=>{
  const f = e.target.files[0];
  if(!f) return;
  const reader = new FileReader();
  reader.onload = ev=>{
    document.getElementById("textInput").value = ev.target.result;
  };
  reader.readAsText(f);
});

/* ---------- MAIN ---------- */
async function startAnalysis(){
  fullText = document.getElementById("textInput").value.trim();
  if(fullText.length < 50){
    alert("Text is too short for meaningful analysis.");
    return;
  }

  const useAI = document.getElementById("aiToggle").checked && OPENAI_API_KEY;

  if(useAI){
    analyzeWithGPT(fullText);
  }else{
    semanticFlow(fullText);
  }
}

/* ---------- SEMANTIC AI ---------- */
function semanticFlow(text){
  const sentences = text.split(/(?<=[.!?])\s+/);
  const ranked = semanticRank(sentences);

  const explanation = semanticExplanation(ranked);
  document.getElementById("analysisBox").textContent = explanation;

  const tasks = semanticTasks(ranked);
  renderTasks(tasks);
}

function semanticRank(sentences){
  return sentences.map(s=>{
    let score=0;
    if(/defined as|means|refers to|is a/i.test(s)) score+=4;
    if(/because|therefore|leads to|as a result/i.test(s)) score+=3;
    if(/includes|consists of|types of|such as/i.test(s)) score+=3;
    if(s.length>80) score+=1;
    return {text:s.trim(), score};
  }).filter(x=>x.score>0)
    .sort((a,b)=>b.score-a.score);
}

function semanticExplanation(items){
  let out="ðŸ“˜ Meaning-based explanation:\n\n";
  const def = items.find(i=>/defined|means|refers/i.test(i.text));
  const cause = items.find(i=>/because|therefore|leads/i.test(i.text));
  const list = items.find(i=>/includes|consists|types of/i.test(i.text));

  if(def) out+="Definition:\n"+def.text+"\n\n";
  if(cause) out+="Cause & Effect:\n"+cause.text+"\n\n";
  if(list) out+="Classification / Components:\n"+list.text+"\n\n";

  out+="This explanation is generated by semantic rules, not random selection.";
  return out;
}

function semanticTasks(items){
  const tasks=[];
  items.slice(0,6).forEach(i=>{
    if(/defined|means|refers/i.test(i.text)){
      tasks.push({q:"Explain this concept in your own words:",ref:i.text});
    }
    else if(/because|therefore|leads/i.test(i.text)){
      tasks.push({q:"Describe the cause-and-effect relationship:",ref:i.text});
    }
    else if(/includes|consists|types of/i.test(i.text)){
      tasks.push({q:"List and explain the elements mentioned:",ref:i.text});
    }
  });
  return tasks;
}

/* ---------- GPT AI ---------- */
async function analyzeWithGPT(text){
  document.getElementById("analysisBox").textContent="Analyzing with real AI...";

  const res = await fetch("https://api.openai.com/v1/chat/completions",{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "Authorization":"Bearer "+OPENAI_API_KEY
    },
    body:JSON.stringify({
      model:"gpt-4o-mini",
      messages:[
        {role:"system",content:"You are an educational assistant."},
        {role:"user",content:
`Analyze the following study material.
1) Give a clear explanation
2) Identify key concepts
3) Generate 5 meaningful study tasks (definitions, cause-effect, explanation)

TEXT:
${text}`}
      ],
      temperature:0.3
    })
  });

  const data = await res.json();
  document.getElementById("analysisBox").textContent =
    data.choices[0].message.content;

  document.getElementById("tasksBox").innerHTML =
    "<div class='badge'>Tasks generated by Real AI</div>";
}

/* ---------- RENDER ---------- */
function renderTasks(tasks){
  const box=document.getElementById("tasksBox");
  box.innerHTML="";
  tasks.forEach((t,i)=>{
    box.innerHTML+=`
      <div class="task">
        <b>Task ${i+1}</b><br>
        ${t.q}
        <div class="ref">Based on text: "${t.ref}"</div>
        <textarea placeholder="Your answer..."></textarea>
      </div>`;
  });
}
</script>
</body>
</html>
